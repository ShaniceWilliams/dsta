---
title: "Latent dimensions"
lang: en
author: DSTA 
format:
  pdf:
    papersize: A4
    number-sections: true
    pdf-engine: pdflatex
  revealjs: 
    theme: solarized
    css: ../../styles/dsta_slides.css
    slide-number: true
    slide-level: 2
    # title-slide-attributes:
      # data-background-image: ../../styles/bbk-logo.svg
    code-fold: false
    echo: true
    # smaller: true
    scrollable: true
  html:
    toc: true
    code-fold: false
    anchor-sections: true
    other-links:
      - text: Class page
        href: https://ale66.github.io/dsta/
jupyter: python3
---

> A presentation of Ch. 11 of Lescovec et al., [[Mining of Massive
> Datasets]{.underline}](http://www.mmds.org/#book)
>
> Slides adapted from Jure Leskovec's slides "Dim. Reduction by SVD"
>
> ![](media/image6.jpeg){width="7.649430227471566in"
> height="2.9661450131233598in"}

-   **Assumption:** Data lies on or near a low

> *d*-dimensional subspace

-   **Axes of this subspace are effective representation of the data**

-   **Compress / reduce dimensionality:**

    -   10^6^ rows; 10^3^ columns; no updates

    -   Random access to any cell(s); **small error: OK**

> The above matrix is really "2-dimensional." All rows can be
> reconstructed by scaling \[1 1 1 0 0\] or \[0 0 0 1 1\]

-   **Q:** What is **rank** of a matrix **A**?

-   **A:** Number of **linearly independent** columns of **A**

-   **For example:**

    -   Matrix **A =**
        ![\\begin{bmatrix}1&2&1\\\\-2&-3&1\\\\3&5&0\\end{bmatrix}](media/image9.png){width="1.4649989063867017in"
        height="0.9999857830271216in"} has rank **r=2**

        -   **Why?** The first two rows are linearly independent, so the
            rank is at least 2, but all three rows are linearly
            dependent (the first is equal to the sum of the second and
            third) so the rank must be less than 3.

-   **Why do we care about low rank?**

    -   We can write **A** as two "basis" vectors: \[1 2 1\] \[-2 -3 1\]

    -   And new coordinates of : \[1 0\] \[0 1\] \[1 1\]

-   **Cloud of points 3D space:**

    -   Think of point positions

> ![\\begin{bmatrix}1&2&1\\\\-2&-3&1\\\\3&5&0\\end{bmatrix}](media/image9.png){width="1.4649989063867017in"
> height="0.9999989063867016in"}as a matrix: **~A~**
>
> **B A**
>
> **1 row per point: C**

-   **We can rewrite coordinates more efficiently!**

    -   Old basis vectors: \[1 0 0\] \[0 1 0\] \[0 0 1\]

    -   **New basis vectors: \[1 2 1\] \[-2 -3 1\]**

    -   Then **A** has new coordinates: \[1 0\]. **B**: \[0 1\], **C**:
        \[1 1\]

        -   **Notice: We reduced the number of coordinates!**

-   **Goal of dimensionality reduction is to discover the axis of
    data!**

> ![](media/image13.jpeg){width="3.6650951443569553in"
> height="4.346665573053368in"}Rather than representing every point with
> 2 coordinates we represent each point with 1 coordinate (corresponding
> to the position of the point on
>
> the red line).
>
> By doing this we incur a bit of **error** as the points do not exactly
> lie on the line
>
> Why reduce dimensions?

-   **Discover hidden correlations/topics**

    -   Words that occur commonly together

-   **Remove redundant and noisy features**

    -   Not all words are useful

-   **Interpretation and visualization**

-   ![](media/image15.jpeg){width="3.0483333333333333in"
    height="2.144998906386702in"}**Easier storage and processing of the
    data**

> J. Leskovec, A. Rajaraman, J. Ullman: Mining of Massive Datasets,
> [http://www.mmds.org](http://www.mmds.org/) 7
>
> **A\[m x n\]** = **U\[m x r\] Σ** **\[** **r x r\]** (**V\[n x r\])**T

-   **A**: **Input data matrix**

    -   *m* x *n* matrix (e.g., *m* documents, *n* terms)

-   **U**: **Left singular vectors**

    -   *m* x *r* matrix (*m* documents, *r* concepts)

-   **Σ**: **Singular values**

    -   *r* x *r* diagonal matrix (strength of each 'concept') (*r* :
        rank of the matrix **A**)

-   **V**: **Right singular vectors**

    -   *n* x *r* matrix (*n* terms, *r* concepts)

T

> n
>
> m ≈ m
>
> **A**
>
> n
>
> **Σ** **VT**

**U**

T

> σ1**u1v1** σ2**u2v2**

m

> **A**

n

> ≈ +
>
> **σi ... scalar ui ... vector vi ... vector**
>
> It is **always** possible to decompose a real matrix ***A*** into ***A
> = U* Σ** ***V*^T^** , where

-   ***U,* Σ*, V***: unique

-   ***U, V***: column orthonormal

    -   ***U^T^ U = I**; **V^T^ V = I ***(***I***: identity matrix)

    -   (Columns are orthogonal unit vectors)

-   **Σ**: diagonal

    -   Entries (**singular values**) are positive,

> and sorted in decreasing order (**σ1 ≥** **σ2 ≥** **\... ≥** **0**)
>
> Nice proof of uniqueness:
> <http://www.mpi-inf.mpg.de/~bast/ir-seminar-ws04/lecture2.pdf>

# A = U Σ V^T^ - example: Users to Movies

> Matrix
>
> Alien Serenity Casablanca Amelie
>
> n

+-------------+-------------+-------------+-----------------+--------+
| > **1**     | > **1**     | > **1**     | > 0             | > 0    |
+=============+=============+=============+=================+========+
| > **3**     | > **3**     | > **3**     | > 0             | > 0    |
+-------------+-------------+-------------+-----------------+--------+
| > **4**     | > **4**     | > **4**     | > 0             | > 0    |
+-------------+-------------+-------------+-----------------+--------+
| > **5**     | > **5**     | > **5**     | > 0             | > 0    |
+-------------+-------------+-------------+-----------------+--------+
| > 0         | > **2**     | > 0         | > **4**         | >      |
|             |             |             |                 |  **4** |
+-------------+-------------+-------------+-----------------+--------+
| > 0         | > 0         | > 0         | > **5**         | >      |
|             |             |             |                 |  **5** |
+-------------+-------------+-------------+-----------------+--------+
| > 0         | > **1**     | > 0         | > **2**         | >      |
|             |             |             |                 |  **2** |
+-------------+-------------+-------------+-----------------+--------+

> SciFi
>
> Romnce
>
> **=** m **Σ**
>
> **U**
>
> **"Concepts"**
>
> **VT**
>
> **AKA Latent dimensions AKA Latent factors**

# A = U Σ V^T^ - example: Users to Movies

> Matrix
>
> Alien Serenity Casablanca Amelie
>
> SciFi

+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0   | > |    | >        | > 0.02    | -0.01     |
|  ** |  ** |  ** |       |   |    | **0.13** |           |           |
| 1** | 1** | 1** |       | 0 |    |          |           |           |
+=====+=====+=====+=======+===+====+==========+===========+===========+
| >   | >   | >   | > 0   | > |    | >        | > 0.07    | -0.03     |
|  ** |  ** |  ** |       |   |    | **0.41** |           |           |
| 3** | 3** | 3** |       | 0 |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0   | > | >  | >        | > 0.09    | > -0.04   |
|  ** |  ** |  ** | >     |   |  * | **0.55** | >         | >         |
| 4** | 4** | 4** | > 0   | 0 | *= | >        | > 0.11    | > -0.05   |
| >   | >   | >   |       | > | ** | >        |           |           |
| >   | >   | >   |       | > |    | **0.68** |           |           |
|  ** |  ** |  ** |       |   |    |          |           |           |
| 5** | 5** | 5** |       | 0 |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| > 0 | >   | > 0 | >     | > |    | > 0.15   | >         | **0.65**  |
|     |  ** |     | **4** |   |    |          | **-0.59** |           |
|     | 2** |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | 4 |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| > 0 | > 0 | > 0 | >     | > |    | > 0.07   | >         | **-0.67** |
|     |     |     | **5** |   |    |          | **-0.73** |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | 5 |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| > 0 | >   | > 0 | >     | > |    | > 0.07   | >         | **0.32**  |
|     |  ** |     | **2** |   |    |          | **-0.29** |           |
|     | 1** |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | 2 |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+

> Romnce
>
> **12.4** 0
>
> **x** 0 **9.5 x**

0

0

**1.3**

> 0 0

**0.56**

0.12

0.40

> **0.59 0.56** 0.09 0.09
>
> -0.02 0.12 **-0.69 -0.69**
>
> **-0.80** 0.40 0.09 0.09

# A = U Σ V^T^ - example: Users to Movies

> Matrix
>
> Alien Serenity Casablanca Amelie
>
> **SciFi-concept**
>
> **Romance-concept**
>
> SciFi

+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0   | > |    | >        | > 0.02    | -0.01     |
|  ** |  ** |  ** |       |   |    | **0.13** |           |           |
| 1** | 1** | 1** |       | 0 |    |          |           |           |
+=====+=====+=====+=======+===+====+==========+===========+===========+
| >   | >   | >   | > 0   | > |    | >        | > 0.07    | -0.03     |
|  ** |  ** |  ** |       |   |    | **0.41** |           |           |
| 3** | 3** | 3** |       | 0 |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0   | > | >  | >        | > 0.09    | > -0.04   |
|  ** |  ** |  ** | >     |   |  * | **0.55** | >         | >         |
| 4** | 4** | 4** | > 0   | 0 | *= | >        | > 0.11    | > -0.05   |
| >   | >   | >   |       | > | ** | >        |           |           |
| >   | >   | >   |       | > |    | **0.68** |           |           |
|  ** |  ** |  ** |       |   |    |          |           |           |
| 5** | 5** | 5** |       | 0 |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| > 0 | >   | > 0 | >     | > |    | > 0.15   | >         | **0.65**  |
|     |  ** |     | **4** |   |    |          | **-0.59** |           |
|     | 2** |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | 4 |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| > 0 | > 0 | > 0 | >     | > |    | > 0.07   | >         | **-0.67** |
|     |     |     | **5** |   |    |          | **-0.73** |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | 5 |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| > 0 | >   | > 0 | >     | > |    | > 0.07   | >         | **0.32**  |
|     |  ** |     | **2** |   |    |          | **-0.29** |           |
|     | 1** |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | 2 |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+

> Romnce
>
> **12.4** 0
>
> **x** 0 **9.5 x**

0

0

**1.3**

> 0 0

**0.56**

0.12

0.40

> **0.59 0.56** 0.09 0.09
>
> -0.02 0.12 **-0.69 -0.69**
>
> **-0.80** 0.40 0.09 0.09

# A = U Σ V^T^ - example:

> Matrix
>
> Alien Serenity Casablanca Amelie
>
> ***U* is "user-to-concept" similarity matrix**
>
> **SciFi-concept Romance-concept**
>
> SciFi

+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0   | > |    | >        | > 0.02    | -0.01     |
|  ** |  ** |  ** |       |   |    | **0.13** |           |           |
| 1** | 1** | 1** |       | 0 |    |          |           |           |
+=====+=====+=====+=======+===+====+==========+===========+===========+
| >   | >   | >   | > 0   | > |    | >        | > 0.07    | -0.03     |
|  ** |  ** |  ** |       |   |    | **0.41** |           |           |
| 3** | 3** | 3** |       | 0 |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0   | > | >  | >        | > 0.09    | > -0.04   |
|  ** |  ** |  ** | >     |   |  * | **0.55** | >         | >         |
| 4** | 4** | 4** | > 0   | 0 | *= | >        | > 0.11    | > -0.05   |
| >   | >   | >   |       | > | ** | >        |           |           |
| >   | >   | >   |       | > |    | **0.68** |           |           |
|  ** |  ** |  ** |       |   |    |          |           |           |
| 5** | 5** | 5** |       | 0 |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| > 0 | >   | > 0 | >     | > |    | > 0.15   | >         | **0.65**  |
|     |  ** |     | **4** |   |    |          | **-0.59** |           |
|     | 2** |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | 4 |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| > 0 | > 0 | > 0 | >     | > |    | > 0.07   | >         | **-0.67** |
|     |     |     | **5** |   |    |          | **-0.73** |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | 5 |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| > 0 | >   | > 0 | >     | > |    | > 0.07   | >         | **0.32**  |
|     |  ** |     | **2** |   |    |          | **-0.29** |           |
|     | 1** |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | 2 |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+

> Romnce
>
> **12.4** 0
>
> **x** 0 **9.5 x**

0

0

**1.3**

> 0 0

**0.56**

0.12

0.40

> **0.59 0.56** 0.09 0.09
>
> -0.02 0.12 **-0.69 -0.69**
>
> **-0.80** 0.40 0.09 0.09

# A = U Σ V^T^ - example:

> Matrix
>
> Alien Serenity Casablanca Amelie
>
> SciFi
>
> **1 1 1** 0
>
> **3 3 3** 0
>
> **4 4 4** 0
>
> **SciFi-concept**
>
> **0.13** 0.02 -0.01
>
> **0.41** 0.07 -0.03
>
> **0.55** 0.09 -0.04
>
> **"strength" of the SciFi-concept**
>
> **12.4** 0

0

0

**1.3**

> Romnce
>
> **5 5 5** 0
>
> 0 **2** 0 **4**
>
> 0 0 0 **5**
>
> 0 **1** 0 **2**
>
> **= 0.68** 0.11 -0.05 **x**
>
> 0.15 **-0.59 0.65**
>
> 0.07 **-0.73 -0.67**
>
> 0.07 **-0.29 0.32**
>
> 0 **9.5 x**
>
> 0 0

**0.56**

0

0

0

0

**4**

**5**

**2**

0.12

0.40

> **0.59 0.56** 0.09 0.09
>
> -0.02 0.12 **-0.69 -0.69**
>
> **-0.80** 0.40 0.09 0.09

# A = U Σ V^T^ - example:

> Matrix
>
> Alien Serenity Casablanca Amelie
>
> **SciFi-concept**
>
> ***V* is "movie-to-concept" similarity matrix**
>
> SciFi

+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0   | > |    | >        | > 0.02    | -0.01     |
|  ** |  ** |  ** |       |   |    | **0.13** |           |           |
| 1** | 1** | 1** |       | 0 |    |          |           |           |
+=====+=====+=====+=======+===+====+==========+===========+===========+
| >   | >   | >   | > 0   | > |    | >        | > 0.07    | -0.03     |
|  ** |  ** |  ** |       |   |    | **0.41** |           |           |
| 3** | 3** | 3** |       | 0 |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0   | > | >  | >        | > 0.09    | > -0.04   |
|  ** |  ** |  ** | >     |   |  * | **0.55** | >         | >         |
| 4** | 4** | 4** | > 0   | 0 | *= | >        | > 0.11    | > -0.05   |
| >   | >   | >   |       | > | ** | >        |           |           |
| >   | >   | >   |       | > |    | **0.68** |           |           |
|  ** |  ** |  ** |       |   |    |          |           |           |
| 5** | 5** | 5** |       | 0 |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| > 0 | >   | > 0 | >     | > |    | > 0.15   | >         | **0.65**  |
|     |  ** |     | **4** |   |    |          | **-0.59** |           |
|     | 2** |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | 4 |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| > 0 | > 0 | > 0 | >     | > |    | > 0.07   | >         | **-0.67** |
|     |     |     | **5** |   |    |          | **-0.73** |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | 5 |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+
| > 0 | >   | > 0 | >     | > |    | > 0.07   | >         | **0.32**  |
|     |  ** |     | **2** |   |    |          | **-0.29** |           |
|     | 1** |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | 2 |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
|     |     |     |       | * |    |          |           |           |
+-----+-----+-----+-------+---+----+----------+-----------+-----------+

> Romnce
>
> **SciFi-concept**
>
> **12.4** 0
>
> **x** 0 **9.5 x**

0

0

**1.3**

> 0 0

+-----------+--------------+------------+--------------+--------------+
| > **0.56  |              |            |              |              |
| > 0.59    |              |            |              |              |
| > 0.56**  |              |            |              |              |
| > 0.09    |              |            |              |              |
| > 0.09    |              |            |              |              |
+===========+==============+============+==============+==============+
| 0.12      | -0.02        | 0.12       | > **-0.69**  | **-0.69**    |
+-----------+--------------+------------+--------------+--------------+
| 0.40      | **-0.80**    | 0.40       | > 0.09       | 0.09         |
+-----------+--------------+------------+--------------+--------------+

> '**movies**', '**users**' and '**concepts**':

-   ***U***: user-to-concept similarity matrix

-   ***V***: movie-to-concept similarity matrix

-   **Σ**: its diagonal elements: 'strength' of each concept

> **Movie 2 rating**

-   Instead of using two coordinates (𝒙𝒙, 𝒚𝒚) to describe point
    locations, let's use only one coordinate

**first right**

**singular vector**

**v1**

**Movie 1 rating**

> 𝒛𝒛

-   Point's position is its location along vector 𝒗𝒗𝟏𝟏

-   **How to choose** 𝒗𝒗𝟏𝟏**? Minimize reconstruction error**

-   **Goal: Minimize the sum of reconstruction errors:**

> **first right singular vector**
>
> **Movie 2 rating**

𝑁𝑁 𝐷𝐷

> 2

� � 𝑥𝑥~𝑖𝑖𝑗𝑗~ − 𝑧𝑧~𝑖𝑖𝑗𝑗~ **~v~1**

𝑖𝑖=1

> 𝑗𝑗=1
>
> **Movie 1 rating**

-   where 𝒙𝒙𝒊𝒊𝒊𝒊 are the "old" and 𝒛𝒛𝒊𝒊𝒊𝒊 are the

> "new" coordinates

-   **SVD gives 'best' axis to project on:**

    -   '**best**' = minimizing the reconstruction errors

-   **In other words, minimum reconstruction error**

# A = U Σ V^T^ - example:

> **first right singular vector**
>
> **Movie 2 rating**

-   **V**: "movie-to-concept" matrix

-   **U**: "user-to-concept" matrix

**v1**

> **1 1 1** 0 0

+-------------+-----------+-------------+--------------+-------------+
| > **0.56**  | >         | > **0.56**  | > 0.09       | 0.09        |
|             |  **0.59** |             |              |             |
+=============+===========+=============+==============+=============+
| > 0.12      | > -0.02   | > 0.12      | > **-0.69**  | **-0.69**   |
+-------------+-----------+-------------+--------------+-------------+
| > 0.40      | >         | > 0.40      | > 0.09       | 0.09        |
|             | **-0.80** |             |              |             |
+-------------+-----------+-------------+--------------+-------------+

+--------------+----------+-------+-----------------------------------+
| > **12.4**   | > 0      | 0     |                                   |
+==============+==========+=======+===================================+
| > 0          | >        | 0     | > **x**                           |
| >            |  **9.5** |       |                                   |
| > 0          | >        | **    |                                   |
|              | > 0      | 1.3** |                                   |
+--------------+----------+-------+-----------------------------------+

> **3 3 3** 0 0
>
> **4 4 4** 0 0
>
> **5 5 5** 0 0
>
> 0 **2** 0 **4 4**
>
> 0 0 0 **5 5**
>
> 0 **1** 0 **2 2**
>
> **0.13** 0.02 -0.01
>
> **0.41** 0.07 -0.03
>
> **0.55** 0.09 -0.04
>
> **= 0.68** 0.11 -0.05 **x**
>
> 0.15 **-0.59 0.65**
>
> 0.07 **-0.73 -0.67**
>
> 0.07 **-0.29 0.32**
>
> **Movie 1 rating**

# A = U Σ V^T^ - example:

> **first right singular vector**
>
> **Movie 2 rating**
>
> **1 1 1** 0 0
>
> **3 3 3** 0 0
>
> **variance ('spread') on the v~1~ axis**
>
> **0.13** 0.02 -0.01
>
> **0.41** 0.07 -0.03
>
> **v1**
>
> **Movie 1 rating**
>
> **4 4 4** 0 0
>
> **5 5 5** 0 0
>
> 0 **2** 0 **4 4**
>
> 0 0 0 **5 5**
>
> 0 **1** 0 **2 2**
>
> **0.55** 0.09 -0.04
>
> **= 0.68** 0.11 -0.05 **x**
>
> 0.15 **-0.59 0.65**
>
> 0.07 **-0.73 -0.67**
>
> 0.07 **-0.29 0.32**
>
> **12.4** 0 0
>
> 0 **9.5** 0 **x**
>
> 0 0 **1.3**
>
> **0.56 0.59 0.56** 0.09 0.09
>
> 0.12 -0.02 0.12 **-0.69 -0.69**
>
> 0.40 **-0.80** 0.40 0.09 0.09

# A = U Σ V^T^ - example: {#a-u-σ-vt---example-5 .unnumbered}

-   **U Σ**: Gives the coordinates of the points in the projection axis

> **first right singular vector**
>
> **v1**
>
> **Movie 1 rating**
>
> **Movie 2 rating**

+---+---+---+-----+---+----------------------------------------------+
| > | > | > | > 0 | 0 | > **Projection of users**                    |
|   |   |   |     |   |                                              |
| * | * | * |     |   |                                              |
| * | * | * |     |   |                                              |
| 1 | 1 | 1 |     |   |                                              |
| * | * | * |     |   |                                              |
| * | * | * |     |   |                                              |
+===+===+===+=====+===+==============================================+
| > | > | > | > 0 | 0 | > **on the "Sci-Fi" axis**                   |
|   |   |   |     |   |                                              |
| * | * | * |     |   |                                              |
| * | * | * |     |   |                                              |
| 3 | 3 | 3 |     |   |                                              |
| * | * | * |     |   |                                              |
| * | * | * |     |   |                                              |
+---+---+---+-----+---+----------------------------------------------+
| > | > | > | > 0 | 0 | > **(U Σ)** **Τ:**                           |
|   |   |   |     |   |                                              |
| * | * | * |     |   |                                              |
| * | * | * |     |   |                                              |
| 4 | 4 | 4 |     |   |                                              |
| * | * | * |     |   |                                              |
| * | * | * |     |   |                                              |
+---+---+---+-----+---+----------------------------------------------+
| > | > | > | > 0 | 0 |                                              |
|   |   |   |     |   |                                              |
| * | * | * |     |   |                                              |
| * | * | * |     |   |                                              |
| 5 | 5 | 5 |     |   |                                              |
| * | * | * |     |   |                                              |
| * | * | * |     |   |                                              |
+---+---+---+-----+---+----------------------------------------------+
| > | > | > | >   | * |                                              |
|   |   |   |  ** | * |                                              |
| 0 | * | 0 | 4** | 4 |                                              |
|   | * |   |     | * |                                              |
|   | 2 |   |     | * |                                              |
|   | * |   |     |   |                                              |
|   | * |   |     |   |                                              |
+---+---+---+-----+---+----------------------------------------------+
| > | > | > | >   | * |                                              |
|   |   |   |  ** | * |                                              |
| 0 | 0 | 0 | 5** | 5 |                                              |
|   |   |   |     | * |                                              |
|   |   |   |     | * |                                              |
+---+---+---+-----+---+----------------------------------------------+
| > | > | > | >   | * |                                              |
|   |   |   |  ** | * |                                              |
| 0 | * | 0 | 2** | 2 |                                              |
|   | * |   |     | * |                                              |
|   | 1 |   |     | * |                                              |
|   | * |   |     |   |                                              |
|   | * |   |     |   |                                              |
+---+---+---+-----+---+----------------------------------------------+

> 0.19 -0.01
>
> 1.61

+------------------+------------------------+-------------------------+
| 5.08             | > 0.66                 | -0.03                   |
+==================+========================+=========================+
| 6.82             | > 0.85                 | -0.05                   |
+------------------+------------------------+-------------------------+
| 8.43             | > 1.04                 | -0.06                   |
+------------------+------------------------+-------------------------+
| 1.86             | > -5.60                | 0.84                    |
+------------------+------------------------+-------------------------+
| 0.86             | > -6.93                | -0.87                   |
+------------------+------------------------+-------------------------+
| 0.86             | > -2.75                | 0.41                    |
+------------------+------------------------+-------------------------+

> More details

-   **Q: How exactly is dim. reduction done?**

> **12.4** 0

0

0

**1.3**

+-----+-----+-----+------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0  | 0 |    | >        | 0.02      | -0.01     |
|  ** |  ** |  ** |      |   |    | **0.13** |           |           |
| 1** | 1** | 1** |      |   |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0  | 0 |    | >        | 0.07      | -0.03     |
|  ** |  ** |  ** |      |   |    | **0.41** |           |           |
| 3** | 3** | 3** |      |   |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0  | > | >  | >        | > 0.09    | > -0.04   |
|  ** |  ** |  ** | >    |   |  * | **0.55** | >         | >         |
| 4** | 4** | 4** | > 0  | 0 | *= | >        | > 0.11    | > -0.05   |
| >   | >   | >   |      | > | ** | >        |           |           |
| >   | >   | >   |      | > |    | **0.68** |           |           |
|  ** |  ** |  ** |      |   |    |          |           |           |
| 5** | 5** | 5** |      | 0 |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| > 0 | >   | > 0 | > *  | * |    | > 0.15   | **-0.59** | **0.65**  |
|     |  ** |     | *4** | * |    |          |           |           |
|     | 2** |     |      | 4 |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| > 0 | > 0 | > 0 | > *  | * |    | > 0.07   | **-0.73** | **-0.67** |
|     |     |     | *5** | * |    |          |           |           |
|     |     |     |      | 5 |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| > 0 | >   | > 0 | > *  | * |    | > 0.07   | **-0.29** | **0.32**  |
|     |  ** |     | *2** | * |    |          |           |           |
|     | 1** |     |      | 2 |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
|     |     |     |      |   |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+

> **x** 0 **9.5 x**
>
> 0 0
>
> **0.56 0.59 0.56** 0.09 0.09

+------------+--------------+------------+--------------+--------------+
| > 0.12     | -0.02        | 0.12       | > **-0.69**  | **-0.69**    |
+============+==============+============+==============+==============+
| > 0.40     | **-0.80**    | 0.40       | > 0.09       | 0.09         |
+------------+--------------+------------+--------------+--------------+

> More details

-   **Q: How exactly is dim. reduction done?**

-   **A: Set smallest singular values to zero**

> **12.4** 0
>
> 0
>
> 0
>
> **1.3**

+-----+-----+-----+------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0  | 0 |    | >        | 0.02      | -0.01     |
|  ** |  ** |  ** |      |   |    | **0.13** |           |           |
| 1** | 1** | 1** |      |   |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0  | 0 |    | >        | 0.07      | -0.03     |
|  ** |  ** |  ** |      |   |    | **0.41** |           |           |
| 3** | 3** | 3** |      |   |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0  | > | >  | >        | > 0.09    | > -0.04   |
|  ** |  ** |  ** | >    |   |  * | **0.55** | >         | >         |
| 4** | 4** | 4** | > 0  | 0 | *= | >        | > 0.11    | > -0.05   |
| >   | >   | >   |      | > | ** | >        |           |           |
| >   | >   | >   |      | > |    | **0.68** |           |           |
|  ** |  ** |  ** |      |   |    |          |           |           |
| 5** | 5** | 5** |      | 0 |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| > 0 | >   | > 0 | > *  | * |    | > 0.15   | **-0.59** | **0.65**  |
|     |  ** |     | *4** | * |    |          |           |           |
|     | 2** |     |      | 4 |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| > 0 | > 0 | > 0 | > *  | * |    | > 0.07   | **-0.73** | **-0.67** |
|     |     |     | *5** | * |    |          |           |           |
|     |     |     |      | 5 |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| > 0 | >   | > 0 | > *  | * |    | > 0.07   | **-0.29** | **0.32**  |
|     |  ** |     | *2** | * |    |          |           |           |
|     | 1** |     |      | 2 |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
|     |     |     |      |   |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+

> **x** 0 **9.5 x**
>
> 0 0
>
> **0.56 0.59 0.56** 0.09 0.09

+------------+--------------+------------+--------------+--------------+
| > 0.12     | -0.02        | 0.12       | > **-0.69**  | **-0.69**    |
+============+==============+============+==============+==============+
| > 0.40     | **-0.80**    | 0.40       | > 0.09       | 0.09         |
+------------+--------------+------------+--------------+--------------+

> More details

-   **Q: How exactly is dim. reduction done?**

-   **A: Set smallest singular values to zero**

> **1 1 1** 0
>
> **3 3 3** 0
>
> **4 4 4** 0
>
> **5 5 5** 0
>
> 0 **2** 0 **4**
>
> 0 0 0 **5**
>
> 0 **1** 0 **2**
>
> **0.13** 0.02 -0.01
>
> **0.41** 0.07 -0.03

0

0

0

0

**4**

**5**

**2**

> **0.55** 0.09 -0.04

**≈**

> **0.68** 0.11 -0.05 **x**
>
> 0.15 **-0.59 0.65**
>
> 0.07 **-0.73 -0.67**
>
> 0.07 **-0.29 0.32**
>
> **12.4** 0
>
> 0 **9.5 x**
>
> 0
>
> 0
>
> **1.3**
>
> 0 0
>
> **0.56 0.59 0.56** 0.09 0.09
>
> 0.12 -0.02 0.12 **-0.69 -0.69**
>
> 0.40 **-0.80** 0.40 0.09 0.09
>
> More details

-   **Q: How exactly is dim. reduction done?**

-   **A: Set smallest singular values to zero**

> **1 1 1** 0
>
> **3 3 3** 0
>
> **4 4 4** 0
>
> **5 5 5** 0
>
> 0 **2** 0 **4**
>
> 0 0 0 **5**
>
> 0 **1** 0 **2**
>
> **0.13** 0.02 -0.01
>
> **0.41** 0.07 -0.03

0

0

0

0

**4**

**5**

**2**

> **0.55** 0.09 -0.04

**≈**

> **0.68** 0.11 -0.05 **x**
>
> 0.15 **-0.59 0.65**
>
> 0.07 **-0.73 -0.67**
>
> 0.07 **-0.29 0.32**
>
> **12.4** 0
>
> 0 **9.5 x**
>
> 0
>
> 0
>
> **1.3**
>
> 0 0

**0.56 0.59 0.56** 0.09

0.09

0.12 -0.02 0.12 **-0.69 -0.69**

0.40 **-0.80** 0.40 0.09 0.09

> More details

-   **Q: How exactly is dim. reduction done?**

-   **A: Set smallest singular values to zero**

> **12.4** 0

+-----+------+------+-------------+-----+-------------+------------+
| **  | > *  | > *  | > 0 0       |     | **0.13**    | > 0.02     |
| 1** | *1** | *1** |             |     |             |            |
+=====+======+======+=============+=====+=============+============+
| **  | > *  | > *  | > 0 0       |     | **0.41**    | > 0.07     |
| 3** | *3** | *3** |             |     |             |            |
+-----+------+------+-------------+-----+-------------+------------+
| >   |      |      | > 0 0       | >   | > **0.55**  | > 0.09     |
| **4 |      |      | >           |  ** | >           | >          |
| > 4 |      |      | > 0 0       | ≈** | > **0.68**  | > 0.11     |
| >   |      |      |             |     |             |            |
| 4** |      |      |             |     |             |            |
| >   |      |      |             |     |             |            |
| >   |      |      |             |     |             |            |
| **5 |      |      |             |     |             |            |
| > 5 |      |      |             |     |             |            |
| >   |      |      |             |     |             |            |
| 5** |      |      |             |     |             |            |
+-----+------+------+-------------+-----+-------------+------------+
| > 0 |      |      |             |     | > 0.15      |            |
| >   |      |      |             |     | > **-0.59** |            |
|  ** |      |      |             |     | >           |            |
| 2** |      |      |             |     | > 0.07      |            |
| > 0 |      |      |             |     | > **-0.73** |            |
| >   |      |      |             |     | >           |            |
| **4 |      |      |             |     | > 0.07      |            |
| >   |      |      |             |     | > **-0.29** |            |
| 4** |      |      |             |     |             |            |
| >   |      |      |             |     |             |            |
| > 0 |      |      |             |     |             |            |
| > 0 |      |      |             |     |             |            |
| > 0 |      |      |             |     |             |            |
| >   |      |      |             |     |             |            |
| **5 |      |      |             |     |             |            |
| >   |      |      |             |     |             |            |
| 5** |      |      |             |     |             |            |
| >   |      |      |             |     |             |            |
| > 0 |      |      |             |     |             |            |
| >   |      |      |             |     |             |            |
|  ** |      |      |             |     |             |            |
| 1** |      |      |             |     |             |            |
| > 0 |      |      |             |     |             |            |
| >   |      |      |             |     |             |            |
| **2 |      |      |             |     |             |            |
| >   |      |      |             |     |             |            |
| 2** |      |      |             |     |             |            |
+-----+------+------+-------------+-----+-------------+------------+

+----+----+----+----+------+-----------+----------------+----------+
|    |    |    |    |      |           |                | > **x**  |
+====+====+====+====+======+===========+================+==========+
|    |    |    |    |      |           |                |          |
+----+----+----+----+------+-----------+----------------+----------+
|    |    |    |    |      |           |                |          |
+----+----+----+----+------+-----------+----------------+----------+
|    |    |    |    |      |           |                |          |
+----+----+----+----+------+-----------+----------------+----------+

> 0 **9.5 x**
>
> **0.56 0.59 0.56** 0.09 0.09
>
> 0.12 -0.02 0.12 **-0.69 -0.69**
>
> More details

-   **Q: How exactly is dim. reduction done?**

-   **A: Set smallest singular values to zero**

0

<table>
<colgroup>
<col style="width: 4%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 7%" />
<col style="width: 3%" />
<col style="width: 13%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 12%" />
<col style="width: 12%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>1</strong></th>
<th><blockquote>
<p><strong>1</strong></p>
</blockquote></th>
<th><blockquote>
<p><strong>1</strong></p>
</blockquote></th>
<th><blockquote>
<p>0</p>
</blockquote></th>
<th>0</th>
<th></th>
<th><strong>0.92</strong></th>
<th><strong>0.95</strong></th>
<th><blockquote>
<p><strong>0.92</strong></p>
</blockquote></th>
<th><blockquote>
<p>0.01</p>
</blockquote></th>
<th>0.01</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>3</strong></td>
<td><blockquote>
<p><strong>3</strong></p>
</blockquote></td>
<td><blockquote>
<p><strong>3</strong></p>
</blockquote></td>
<td><blockquote>
<p>0</p>
</blockquote></td>
<td>0</td>
<td></td>
<td><strong>2.91</strong></td>
<td><strong>3.01</strong></td>
<td><blockquote>
<p><strong>2.91</strong></p>
</blockquote></td>
<td><blockquote>
<p>-0.01</p>
</blockquote></td>
<td><blockquote>
<p>-0.01</p>
</blockquote></td>
</tr>
</tbody>
</table>

<table>
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 17%" />
<col style="width: 13%" />
<col style="width: 10%" />
<col style="width: 12%" />
<col style="width: 11%" />
<col style="width: 11%" />
</colgroup>
<thead>
<tr class="header">
<th><blockquote>
<p><strong>4</strong></p>
<p><strong>5</strong></p>
</blockquote></th>
<th><blockquote>
<p><strong>4</strong></p>
<p><strong>5</strong></p>
</blockquote></th>
<th><blockquote>
<p><strong>4</strong></p>
<p><strong>5</strong></p>
</blockquote></th>
<th><blockquote>
<p>0</p>
<p>0</p>
</blockquote></th>
<th><blockquote>
<p>0 <strong>≈</strong></p>
</blockquote></th>
<th><blockquote>
<p><strong>3.90</strong></p>
<p><strong>4.82</strong></p>
</blockquote></th>
<th><blockquote>
<p><strong>4.04</strong></p>
<p><strong>5.00</strong></p>
</blockquote></th>
<th><blockquote>
<p><strong>3.90</strong></p>
<p><strong>4.82</strong></p>
</blockquote></th>
<th><blockquote>
<p>0.01</p>
<p>0.03</p>
</blockquote></th>
<th><blockquote>
<p>0.01</p>
<p>0.03</p>
</blockquote></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td><blockquote>
<p><strong>2</strong></p>
</blockquote></td>
<td><blockquote>
<p>0</p>
</blockquote></td>
<td><blockquote>
<p><strong>4</strong></p>
</blockquote></td>
<td><blockquote>
<p><strong>4</strong></p>
</blockquote></td>
<td>0.70</td>
<td><blockquote>
<p><strong>0.53</strong></p>
</blockquote></td>
<td>0.70</td>
<td><blockquote>
<p><strong>4.11</strong></p>
</blockquote></td>
<td><blockquote>
<p><strong>4.11</strong></p>
</blockquote></td>
</tr>
<tr class="even">
<td>0</td>
<td><blockquote>
<p>0</p>
</blockquote></td>
<td><blockquote>
<p>0</p>
</blockquote></td>
<td><blockquote>
<p><strong>5</strong></p>
</blockquote></td>
<td><blockquote>
<p><strong>5</strong></p>
</blockquote></td>
<td>-0.69</td>
<td><blockquote>
<p>1.34</p>
</blockquote></td>
<td>-0.69</td>
<td><strong>4.78</strong></td>
<td><blockquote>
<p><strong>4.78</strong></p>
</blockquote></td>
</tr>
<tr class="odd">
<td>0</td>
<td><blockquote>
<p><strong>1</strong></p>
</blockquote></td>
<td><blockquote>
<p>0</p>
</blockquote></td>
<td><blockquote>
<p><strong>2</strong></p>
</blockquote></td>
<td><blockquote>
<p><strong>2</strong></p>
</blockquote></td>
<td>0.32</td>
<td><blockquote>
<p><strong>0.23</strong></p>
</blockquote></td>
<td>0.32</td>
<td><blockquote>
<p><strong>2.01</strong></p>
</blockquote></td>
<td><blockquote>
<p><strong>2.01</strong></p>
</blockquote></td>
</tr>
</tbody>
</table>

> **Frobenius [norm: ]{.underline}**
>
> ǁA-Bǁ
>
> = √ Σ
>
> (A -B )2
>
> ǁMǁF
>
> = √Σij
>
> Mij2

F

> is "small"
>
> ij ij ij
>
> Sigma
>
> =

VT

> A
>
> U
>
> **B is best approximation of A**
>
> **U**

VT

B

ma

> Sig
>
> =

-   **[Theorem:]{.underline}**

> Let **A** = **U Σ** **V**^T^ and **B** = **U S V**^T^ where
>
> **S** = **diagonal *r*x*r* matrix** with ***si=σi*** (*i=1...**k***)
> else ***si*=0**
>
> then **B** is a **best** rank(**B**)=***k*** approx. to ***A***
>
> What do we mean by "best":

-   ***B* is a solution to min*B* ǁ*A-B*ǁF where rank(*B*)=*k***

𝜎𝜎11

Σ

𝜎𝜎𝑟𝑟𝑟𝑟

> ![](media/image38.png){width="7.190179352580928e-2in"
> height="0.227166447944007in"} 𝐴𝐴 − 𝐵𝐵
> ![](media/image38.png){width="7.190179352580928e-2in"
> height="0.227166447944007in"} 𝐹𝐹 =

2

> � 𝐴𝐴𝑖𝑖𝑗𝑗 − 𝐵𝐵𝑖𝑖𝑗𝑗
>
> 𝑖𝑖𝑗𝑗
>
> Equivalent:
>
> 'spectral decomposition' of the matrix:
>
> x x
>
> σ1

2

=

+----------------+------------+------------+-----------------+-------+
| **1**          | > **1**    | > **1**    | > 0             | > 0   |
+================+============+============+=================+=======+
| **3**          | > **3**    | > **3**    | > 0             | > 0   |
+----------------+------------+------------+-----------------+-------+
| **4**          | > **4**    | > **4**    | > 0             | > 0   |
+----------------+------------+------------+-----------------+-------+
| **5**          | > **5**    | > **5**    | > 0             | > 0   |
+----------------+------------+------------+-----------------+-------+
| 0              | > **2**    | > 0        | > **4**         | >     |
|                |            |            |                 | **4** |
+----------------+------------+------------+-----------------+-------+
| 0              | > 0        | > 0        | > **5**         | >     |
|                |            |            |                 | **5** |
+----------------+------------+------------+-----------------+-------+
| 0              | > **1**    | > 0        | > **2**         | >     |
|                |            |            |                 | **2** |
+----------------+------------+------------+-----------------+-------+

> u1 u2 σ
>
> v1 v2
>
> Equivalent:
>
> 'spectral decomposition' of the matrix
>
> ![](media/image39.png){width="0.5000010936132984in"
> height="8.333333333333333e-2in"} **m**
> ![](media/image40.png){width="0.7500021872265967in"
> height="8.333333333333333e-2in"}
>
> **k terms**

+----------------+------------+------------+-----------------+-------+
| **1**          | > **1**    | > **1**    | > 0             | > 0   |
+================+============+============+=================+=======+
| **3**          | > **3**    | > **3**    | > 0             | > 0   |
+----------------+------------+------------+-----------------+-------+
| **4**          | > **4**    | > **4**    | > 0             | > 0   |
+----------------+------------+------------+-----------------+-------+
| **5**          | > **5**    | > **5**    | > 0             | > 0   |
+----------------+------------+------------+-----------------+-------+
| 0              | > **2**    | > 0        | > **4**         | >     |
|                |            |            |                 | **4** |
+----------------+------------+------------+-----------------+-------+
| 0              | > 0        | > 0        | > **5**         | >     |
|                |            |            |                 | **5** |
+----------------+------------+------------+-----------------+-------+
| 0              | > **1**    | > 0        | > **2**         | >     |
|                |            |            |                 | **2** |
+----------------+------------+------------+-----------------+-------+

**= σ1**

> **u1 v^T^1 + σ2**
>
> **u2 v^T^2**
>
> **+\...**
>
> **n x 1 1 x m**
>
> **n**

**Assume: σ~1~**

> **≥** **σ2**
>
> **≥** **σ3**
>
> **≥** **\... ≥** **0**
>
> **Why is setting small σi to 0 the right thing to do?**
>
> Vectors **ui** and **vi** are unit length, so **σi**
>
> scales them.
>
> So, zeroing small **σi** introduces less error.
>
> **Q: How many σs to keep? A:** Rule-of-a thumb:
>
> **keep 80-90% of 'energy'** = ∑𝒊𝒊 𝝈𝝈^𝟐𝟐^

𝒊𝒊

> ![](media/image39.png){width="0.5000021872265967in"
> height="8.333333333333333e-2in"} **m**
> ![](media/image40.png){width="0.7500010936132984in"
> height="8.333333333333333e-2in"}
>
> **1 1 1** 0 0
>
> **3 3 3** 0 0
>
> **4 4 4** 0 0

**=**

> **n 5 5 5** 0 0
>
> 0 **2** 0 **4 4**
>
> **σ1 u1**
>
> **v^T^1 + σ2**
>
> **u2 v^T^2**
>
> **+\...**
>
> 0 0 0 **5 5**
>
> 0 **1** 0 **2 2**
>
> **Assume: σ~1~ ≥** **σ~2~ ≥** **σ~3~ ≥** **\...**

-   **To compute SVD:**

    -   **O(nm^2^)** or **O(n^2^m)** (whichever is less)

-   **But:**

    -   Less work, if we just want singular values

    -   or if we want first *k* singular vectors

    -   or if the matrix is sparse

-   **Implemented in** linear algebra packages like

    -   LINPACK, Matlab, SPlus, Mathematica \...

-   **SVD: A= U Σ** **V**^T^: **unique**

    -   **U**: user-to-concept similarities

    -   **V**: movie-to-concept similarities

    -   **Σ** : strength of each concept

-   **Dimensionality reduction:**

    -   keep the few largest singular values (80-90% of 'energy')

    -   SVD: picks up linear correlations

-   **Q: Find users that like 'Matrix'**

-   **A: Map query into a 'concept space' -- how?**

> Matrix
>
> Alien Serenity Casablanca Amelie
>
> SciFi

+-----+-----+-----+------+---+----+----------+-----------+-----------+
|     |     |     |      |   |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0  | 0 |    | >        | > 0.02    | -0.01     |
|  ** |  ** |  ** |      |   |    | **0.13** |           |           |
| 1** | 1** | 1** |      |   |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0  | 0 |    | >        | > 0.07    | -0.03     |
|  ** |  ** |  ** |      |   |    | **0.41** |           |           |
| 3** | 3** | 3** |      |   |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| >   | >   | >   | > 0  | 0 | >  | >        | > 0.09    | > -0.04   |
|  ** |  ** |  ** | >    |   |  * | **0.55** | >         | >         |
| 4** | 4** | 4** | > 0  | 0 | *= | >        | > 0.11    | > -0.05   |
| >   | >   | >   |      |   | ** | >        |           |           |
| >   | >   | >   |      |   |    | **0.68** |           |           |
|  ** |  ** |  ** |      |   |    |          |           |           |
| 5** | 5** | 5** |      |   |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| > 0 | >   | > 0 | > *  | * |    | > 0.15   | >         | **0.65**  |
|     |  ** |     | *4** | * |    |          | **-0.59** |           |
|     | 2** |     |      | 4 |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| > 0 | > 0 | > 0 | > *  | * |    | 0.07     | **-0.73** | **-0.67** |
|     |     |     | *5** | * |    |          |           |           |
|     |     |     |      | 5 |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
| > 0 | >   | > 0 | > *  | * |    | > 0.07   | >         | **0.32**  |
|     |  ** |     | *2** | * |    |          | **-0.29** |           |
|     | 1** |     |      | 2 |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
|     |     |     |      | * |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
|     |     |     |      |   |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+
|     |     |     |      |   |    |          |           |           |
+-----+-----+-----+------+---+----+----------+-----------+-----------+

> Romnce
>
> **12.4** 0
>
> **x** 0 **9.5 x**

0

0

**1.3**

> 0 0
>
> **0.56 0.59 0.56** 0.09 0.09
>
> 0.12 -0.02 0.12 **-0.69 -0.69**
>
> 0.40 **-0.80** 0.40 0.09 0.09

-   **Q: Find users that like 'Matrix'**

-   **A: Map query into a 'concept space' -- how?**

**q**

> **v1**
>
> **q** =
>
> 5
>
> Matrix
>
> Alien Serenity Casablanca Amelie
>
> Alien
>
> 0 0 0 **v2**
>
> **Project into concept space:**

0

> Matrix

-   **Q: Find users that like 'Matrix'**

-   **A: Map query into a 'concept space' -- how?**

> **q** =
>
> 5
>
> Matrix
>
> Alien Serenity Casablanca Amelie
>
> Alien
>
> 0 0 0 **v2**

**q**

**v1**

**q\*v1**

Matrix

> **Project into concept space:**

0

> **Compactly, we have: qconcept = q V**
>
> E.g.:

SciFi-concept

> Matrix
>
> Alien Serenity Casablanca Amelie

+----------------------------------+-----------------------------------+
| > 0.56                           | > 0.12                            |
+==================================+===================================+
| > 0.59                           | > -0.02                           |
+----------------------------------+-----------------------------------+
| > 0.56                           | > 0.12                            |
+----------------------------------+-----------------------------------+
| > 0.09                           | > -0.69                           |
+----------------------------------+-----------------------------------+

> **q** =
>
> 5
>
> 0 0 0 0 **x**
>
> **=** 2.8 0.6

-   **How would the user *d* that rated ('Alien', 'Serenity') be
    handled? dconcept = d V**

> E.g.:

SciFi-concept

> Matrix
>
> Alien Serenity Casablanca Amelie

+----------------------------------+-----------------------------------+
| > 0.56                           | > 0.12                            |
+==================================+===================================+
| > 0.59                           | > -0.02                           |
+----------------------------------+-----------------------------------+
| > 0.56                           | > 0.12                            |
+----------------------------------+-----------------------------------+
| > 0.09                           | > -0.69                           |
+----------------------------------+-----------------------------------+

> **q** =
>
> 0
>
> 4 5 0 0 **x**
>
> **=** 5.2 0.4

-   **Observation:** User ***d*** that rated ('*Alien*', '*Serenity*')
    will be **similar** to user **q** that rated ('*Matrix*'), although
    ***d*** and **q** have **zero ratings in common**!

SciFi-concept

> Matrix
>
> Alien Serenity Casablanca Amelie
>
> **d =** 0 4 5 0 0
>
> 5.2 0.4
>
> **q =** 5 0 0 0 0
>
> 2.8 0.6
>
> **Zero ratings in common** Similarity ≠ 0
>
> \+ **Optimal low-rank approximation** in terms of Frobenius norm
> **Interpretability problem:**

\-

-   A singular vector specifies a linear combination of all input
    columns or rows

\-

> Lack of sparsity:

-   Singular vectors are **dense!**

> ![](media/image53.png){width="0.33999890638670166in"
> height="1.8649989063867016in"}![](media/image54.png){width="0.26166557305336835in"
> height="0.2816655730533683in"}
> ![](media/image55.png){width="1.1099989063867017in"
> height="0.2816655730533683in"} VT
>
> Σ
>
> =

U
